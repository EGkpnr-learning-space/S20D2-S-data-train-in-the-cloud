============================= test session starts ==============================
platform linux -- Python 3.10.6, pytest-9.0.2, pluggy-1.6.0 -- /home/egkpnr/.pyenv/versions/3.10.6/envs/taxifare-env/bin/python
cachedir: .pytest_cache
rootdir: /home/egkpnr/code/EGkpnr/S20D1-S-/S20D2-S-data-train-in-the-cloud/tests
configfile: pytest_kitt.ini
collecting ... collected 9 items

tests/cloud_training/test_cloud_data.py::TestCloudData::test_big_query_dataset_variable_exists PASSED [ 11%]
tests/cloud_training/test_cloud_data.py::TestCloudData::test_cloud_data_create_dataset PASSED [ 22%]
tests/cloud_training/test_cloud_data.py::TestCloudData::test_cloud_data_create_table FAILED [ 33%]
tests/cloud_training/test_main.py::TestMain::test_route_preprocess PASSED [ 44%]
tests/cloud_training/test_main.py::TestMain::test_route_train[local] PASSED [ 55%]
tests/cloud_training/test_main.py::TestMain::test_route_train[gcs] PASSED [ 66%]
tests/cloud_training/test_main.py::TestMain::test_route_evaluate PASSED  [ 77%]
tests/cloud_training/test_main.py::TestMain::test_route_pred PASSED      [ 88%]
tests/cloud_training/test_vm.py::test_i_am_a_vm FAILED                   [100%]

=================================== FAILURES ===================================
__________________ TestCloudData.test_cloud_data_create_table __________________

self = <tests.cloud_training.test_cloud_data.TestCloudData object at 0x712f223708b0>

    def test_cloud_data_create_table(self):
        """
        verify that the bq dataset tables are created and the Makefile variables correct
        """
        expected_tables = ["processed_1k", "processed_200k", "processed_all"]
        dataset = BQ_DATASET
        if dataset is None:
            raise ValueError("The BQ_DATASET environment variable is not set")
        client = bigquery.Client(project=GCP_PROJECT)
        tables = [table.table_id for table in client.list_tables(dataset)]
        for table in expected_tables:
>           assert table in tables, f"Table {table} is missing from the {dataset} dataset"
E           AssertionError: Table processed_200k is missing from the mlops dataset
E           assert 'processed_200k' in ['mlops_1k', 'mlops_200k', 'mlops_all', 'processed_1k']

tests/cloud_training/test_cloud_data.py:43: AssertionError
________________________________ test_i_am_a_vm ________________________________

    def test_i_am_a_vm():
        """
        Test that this code is being run from a Google VM named as per env variable 'INSTANCE'
        """
    
>       assert platform.node() == INSTANCE, f"You should be running from your instance named '{INSTANCE}'."
E       AssertionError: You should be running from your instance named 'taxi-instance'.
E       assert 'EGkpnr' == 'taxi-instance'
E         
E         - taxi-instance
E         + EGkpnr

tests/cloud_training/test_vm.py:9: AssertionError
=========================== short test summary info ============================
FAILED tests/cloud_training/test_cloud_data.py::TestCloudData::test_cloud_data_create_table
FAILED tests/cloud_training/test_vm.py::test_i_am_a_vm - AssertionError: You ...
================== 2 failed, 7 passed, 18 warnings in 18.27s ===================
